# Expresso

**UNA - Universidad Nacional de Costa Rica**  
**EIF400 - Programming Paradigms - II Semester 2025**  
**Professor:** Carlos Loria Saenz  
**Project:** Expresso ‚Äì Medium Sprint  
**Group:** 03 6PM

**Authors:**

- Jose Luis Valverde Solis (Coordinator)
- Eduardo Fonseca Castro
- Rodrigo Castro Rojas
- Diego Alonso Sanchez Jimenez

---

## üìú Project Description

**Expresso** is a command-line tool developed in **Java 23** that simulates the **transpilation**, **compilation**, and **execution** of files with the `.expresso` extension.  
Its main goal is to practice **file management**, **process execution**, and **modular design** in Java, without relying on external scripts or `.jar` execution.

Expresso uses [Picocli](https://picocli.info/#_getting_started) to handle command-line argument parsing, making it easy to define commands and options for the CLI interface.  
[ANTLR4](https://www.antlr.org/) is used for language parsing and syntax analysis of `.expresso` files, enabling future features like AST generation and code transpilation.

---

## ‚öôÔ∏è Commands

### 1. **Transpile**

```
expressor transpile filename.expresso [--out <directory>] [--verbose] [--showTree] [--showTrees]
```

- Simulates transpilation of `.expresso` to `.java`.
- Reads a template from `resources/templates/`.
- Generates the `.java` file in the directory specified with `--out` (or current directory if omitted).
- `--verbose` shows detailed process logs.
- `--showTree` and `--showTrees` options are reserved for future AST visualization.

### 2. **Build**

```
expressor build filename.expresso [--out <directory>] [--verbose] [--showTree] [--showTrees]
```

- Runs transpile and then compiles the generated `.java` using JavaCompiler, also running the typer implicitly.
- Saves the `.class` file in the specified directory or current one.
- `--verbose` shows compilation details.
- `--showTree` and `--showTrees` options are reserved for future AST visualization.

### 3. **Run**

```
expressor run filename.expresso [--out <directory>] [--verbose] [--showTree] [--showTrees]
```

- Executes the `.class` file generated.
- Internally runs transpile ‚Üí build ‚Üí typer ‚Üí execution.
- `--verbose` shows all steps.
- `--showTree` and `--showTrees` options are reserved for future AST visualization.


### 4. **Typer**

```
expressor typer filename.expresso [--out <directory>] [--verbose]
```
-   **Function:** Executes the static type analysis phase on `.expresso` files.
-   **Purpose:** Identifies type errors (e.g., undefined identifiers, redefinitions, type mismatches) and collects type information.
-   **Output:** Generates a `.typings` file (e.g., `filename.expresso.typings`) containing detected types and any issues.
-   **Process:** A visitor traverses the Abstract Syntax Tree (AST), checking types against a symbol table and reporting errors. Implicitly, `build` and `run` commands will halt if Typer detects critical errors.
-   **Options:**
    -   `--out <directory>`: Specifies the output directory for the `.typings` file.
    -   `--verbose`: Provides detailed logs of the typing process.
    -   `--showTree` / `--showTrees`: Reserved for future AST visualization.
  
---

## üöÄ Compilation and Execution

### Pre-requisites

- Oracle JDK 23 installed and configured.
- Gradle 9.0.0 (or use the included Gradle Wrapper).
- No `.jar` execution ‚Äî the project runs from the `.exe` generated by jpackage.

---

### Build the Executable

You can use the options below to build the executable:

1. If the wrapper is not found in the project base directory, ensure Gradle 9.0 is installed, and execute:
   ```
   gradle wrapper --gradle-version 9.0
   ```
   This will generate the following files:
   - gradlew
   - gradlew.bat
   - gradle/wrapper/gradle-wrapper.properties
   - gradle/wrapper/gradle-wrapper.jar
2. To build the executable if Gradle is installed, execute:
   ```
   gradle clean build generateGrammarSource
   ```
3. If Gradle is not installed, you can still build the executable using the existing wrapper in the project base directory:
   ```
   .\gradlew clean build generateGrammarSource
   ```

In any case, this will generate the file:

```
build/exe/expressor/expressor.exe
```

---

### Update PATH (Manual task)

Once the build is able to run successfully, it will provide the information about the expressor file locations, make sure to update the environment variable PATH immediately before starting to use expressor as a command:

1. Add <Project_Directory> (Ex. \Expresso\build\exe\expressor) to the PATH evironment variable of the computer used to run the project.
2. If you have Chocolatey installed, execute the command:

```
refreshenv
```

3. In case it's not installed you can open a powershell terminal and run the following command to refresh the environment variable:

```
$env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine")
```

4. (Recommended for testing) After updating the PATH, move to the folder containing the test files:

```
cd test
```

Then you can run commands like:

```
expressor run HelloWorld.expresso
```

---

## üìÇ Project Structure

```
src/                  # Java source code
src/antlr             # Grammar location with ANTLR4
resources/templates/  # Java templates for transpilation
build/exe/expressor/  # Generated executable
test/                 # Test cases grouped by folders
```

---

## üìö References

- Class Material UNA EIF400-II-2025

Links:

- https://www.oracle.com/latam/java/technologies/javase-jdk24-doc-downloads.html
- https://picocli.info/#_getting_started
- https://github.com/remkop/picocli/blob/main/picocli-examples/annotation-processing/example-gradle-project/src/main/java/com/company/Main.java
- https://www.oracle.com/latam/java/technologies/downloads/
- https://docs.gradle.org/current/samples/sample_building_java_applications.html
- https://stackoverflow.com/questions/20728621/running-an-executable-jar-file-built-from-a-gradle-based-project
- https://www.jetbrains.com/help/idea/getting-started-with-gradle.html
- https://www.antlr.org/
- https://github.com/antlr/antlr4
- https://www.antlr2.org/doc/metalang.html
- https://tomassetti.me/best-practices-for-antlr-parsers/
- https://stackoverflow.com/questions/12898052/antlr-how-to-skip-multiline-comments
- https://www.google.com/search?q=equivalent+to+try+catch+or+if+else+in+functional+programming+java&sca_esv=32c31fc24eb89b34&rlz=1C1GCEA_enCR1075CR1075&ei=BWy0aNi_GaCTwbkP4o2duAw&oq=equivalent+to+try+catch+or+if+else+in+functional+pr&gs_lp=Egxnd3Mtd2l6LXNlcnAiM2VxdWl2YWxlbnQgdG8gdHJ5IGNhdGNoIG9yIGlmIGVsc2UgaW4gZnVuY3Rpb25hbCBwcioCCAEyBRAhGKABMgUQIRigATIFECEYoAEyBRAhGJ8FSO6JAVAAWLV8cAJ4AJABAJgB3AGgAccoqgEGMC4zNS4xuAEByAEA-AEBmAIdoALuHsICBRAAGO8FwgIIEAAYgAQYogTCAgQQIRgVwgIHECEYoAEYCpgDAJIHBDIuMjegB42QAbIHBDAuMje4B-wewgcGMS4yNy4xyAcm&sclient=gws-wiz-serp
- https://www.google.com/search?q=functional+programming+java&sca_esv=32c31fc24eb89b34&rlz=1C1GCEA_enCR1075CR1075&ei=BWy0aNi_GaCTwbkP4o2duAw&oq=functional+pro&gs_lp=Egxnd3Mtd2l6LXNlcnAiDmZ1bmN0aW9uYWwgcHJvKgIIATIFEAAYgAQyBRAAGIAEMgUQABiABDIFEAAYgAQyBRAAGIAEMgUQABiABDIFEAAYgAQyBRAAGIAEMgUQABiABDIFEC4YgARI1CVQAFiuFnABeACQAQCYAaYBoAGfD6oBBDAuMTW4AQHIAQD4AQGYAhCgAtQPqAIKwgIKEAAYgAQYQxiKBcICDhAuGIAEGLEDGNEDGMcBwgIIEAAYgAQYsQPCAgsQABiABBixAxiDAcICEBAAGAMYtAIY6gIYjwHYAQHCAhAQLhgDGLQCGOoCGI8B2AEBwgIREC4YgAQYsQMY0QMYgwEYxwHCAgsQLhiABBixAxiDAcICDhAuGIAEGLEDGIMBGIoFwgIOEAAYgAQYsQMYgwEYigXCAhAQABiABBixAxhDGIMBGIoFwgIOEC4YgAQYsQMYxwEYrwHCAgsQLhiABBjHARivAcICCxAuGIAEGNEDGMcBmAME8QXSGezszrm19LoGBAgBGAqSBwQxLjE1oAfQjgGyBwQwLjE1uAfQD8IHBjAuMTEuNcgHLw&sclient=gws-wiz-serp
- https://docs.oracle.com/javase/8/docs/api/java/lang/Number.html
- https://pgrandinetti.github.io/compilers/page/how-to-build-a-new-programming-language/

AI used for the development of the project:

- https://claude.ai/share/72a921a0-cf92-4f5a-939a-61a0229cccd2
- https://claude.ai/share/2b1e2c41-3c59-42cd-97ec-b15a55ee2143
- https://claude.ai/share/973e6739-14c0-40ba-a9d2-7d7cf96a2b7c
- https://claude.ai/share/ee16eaef-5570-4f33-86bd-f23275045d7b
- https://aistudio.google.com/prompts/1yaituA7namoWU-mIluNbMI5pHtnJFojn
- https://chatgpt.com/share/68e29b44-2b00-800e-b1cc-b3a2f8e2a5fd
- https://chatgpt.com/share/68e29c55-363c-800e-99ca-3cb43492c42b
- https://chatgpt.com/share/68e29cf4-885c-800e-be16-57778c713fec
- https://aistudio.google.com/app/prompts?state=%7B%22ids%22:%5B%221nrHi88OBBFWv8W615td8EtuOgJ1Bi6rH%22%5D,%22action%22:%22open%22,%22userId%22:%22111420068057235619606%22,%22resourceKeys%22:%7B%7D%7D&usp=sharing

- Test
- https://chatgpt.com/share/6910cdb3-e204-8012-bbdb-8e007991bed3
---

# Project Flow

Command: run | build | transpile | typer
|
v
ANTLR Parser: tokens + parse tree
|
v
AstBuilder: ParseTree -> AST / Custom AST
|
v
Typer: Check node Types
| <file>.expresso.typings
|
| If ERROR -> Throw Error
|
v
FeatureCollector: Collect used features
|
v
AstTranspiler: Custom AST -> archivo .java
|
v
javac: .java -> .class
|
v
java: .class Execution
|
v
Console: Output

EOF
